# ble_access_center
-------------------------------------------------------------------------------

## 1，说明

该示例程序是 MXCHIP 自主开发的子设备接入协议的 Demo 实现。通俗的讲，子设备接入协议就是在保证多个子设备功耗低的前提下，完成多个子设备能够及时快速的连接到主设备的星型网络中。具体的原理请关注文档 SF1050CN。需要指出的是，该示例程序依赖于 ble_access 组件，并且需要其它支持此协议标准的从设备共同演示功能。

MXCHIP 已经针对此子设备接入协议完成 EMW3239 作为主设备，EMB1036/EMB1001 作为从设备构造的一整套演示方案。更多信息请关注庆科。

该示例程序完成了该协议的扫描、连接、断开以及重连等功能，此 Demo 是 EMW3239 作为主设备对此协议的实现版本。具体功能包括：

* 使用命令ble_scan开始扫描周围支持此子设备接入协议的从设备。
* 将扫描到的从设备自动与之建立连接并绑定。
* 等待从设备端的用户确认是否与主设备建立连接。
* 建立绑定完成后可以使用 ble_auto_conn 指令开始自动重连过程，此后从设备会在随机时间后断开并进入低功耗状态，当从设备收到外部中断或者定时中断会唤醒并自动进入重连模式，主设备会立即与此进入重连模式的从设备建立连接，如此循环测试。
* 可以使用ble_auto_conn停止当前的自动连接过程并且再次向网路添加新的子设备。

## 2，指令说明

* `ble_scan`：  扫描符合协议的子设备，用户将收到`BLE_ACCESS_EVENT_DEV_NEW`消息 
* `ble_add <device_id>`： 添加一个新的子设备，成功后收到相关消息
* `ble_disc <device_id> <sleep_time>`：将指定的子设备断开并使其进入低功耗睡眠状态。如果指定了sleep_time，那么子设备将在此时间段后自动唤醒并被重连。
* `ble_auto_conn <mode>`： 开启自动连接或者停止。开启自动连接后，主设备会监听处于重连模式的子设备并与之快速重连。
* `ble_rm <device_id>`：移除一个指定的子设备，此子设备将不再被网管主设备管理，主设备也不再与之重连。
